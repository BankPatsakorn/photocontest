<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, 
     user-scalable=0'>
    <title>Photo Contest</title>
    <!-- Bootstrap CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

        <link rel="stylesheet" href="script/Spinner/css/iosOverlay.css">
        <link rel="stylesheet" href="script/Spinner/css/prettify.css">
    <link rel="stylesheet" type="text/css" href="script/slick-1.8.1/slick/slick.css" />
    <link rel="stylesheet" type="text/css" href="script/slick-1.8.1/slick/slick-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css">

</head>

<body>
    <div class="container">
        <!-- UPLOAD -->
        <div id="divUpload">
            <div class="row">

                <div class="col-12 rounded mt-2">
                    <div class="row d-flex justify-content-center">
                        <div class="col-12">
                            <div class="col-12 p-0 text-left">
                                <img src="img/logo-toyota.png" width="100" height="30" />
                            </div>
                            <div class="col-12 pt-2 text-center">
                                <img src="img/aw/campaign_logo.png" width="90%" height="130px" />
                            </div>
                            <div class="col-12 pt-2 text-center">
                                <img src="img/aw/empty_pic.jpg" width="90%" id="OutputImg" height="200px" />
                            </div>
                            <div class="form-group p-2 text-center">
                                <label for="file-upload" class="col-12" style="">
                                    <img id="btnUploadImg" src="img/aw/Upload_Button@2x.png" width="70%"
                                        height="50"></button>
                                </label>
                                <input id="file-upload" type="file" accept="image/png,image/jpg,image/jpeg"
                                    onchange="loadFile(event)" />
                                <p class="pt-2 textwarning">* กรุณาอัปโหลดรูปไม่เกิน 3 MB</p>
                            </div>

                        </div>

                    </div>
                    <div id="divPictures" class="col-12 pl-2">
                        <p class="textwarning" style="font-weight: 600;padding-left: 10px;">
                            รูปภาพที่อัปโหลดแล้วของคุณ <span style="font-weight:normal;color: gray;"
                                id="numpic">(01/20)</span>
                        </p>
                        <section class="regular slider" id="sectionPictures">
                            <div>
                                <img src="http://placehold.it/300x100?text=1" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=2" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=3" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=4" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=5" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=6" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=7" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=8" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=9" height="60">
                            </div>
                            <div>
                                <img src="http://placehold.it/300x100?text=10" height="60">
                            </div>
                        </section>
                    </div>

                    <div class="px-2 pb-4 buttonFooter text-center">
                        <button id="btnSubmit" onclick="submit()" class="col-12 btn py-2 btn-primary btn-lg">
                            Submit
                        </button>
                    </div>
                </div>

            </div>
        </div>
        <div id="divThankyou" style="display: none;">
            <div class="row">
                <div class="col-12 rounded mt-2">
                    <div class="row d-flex justify-content-center">
                        <div class="col-12 pt-2">
                            <div class="col-12 p-0 text-left">
                                <img src="img/logo-toyota.png" width="100" height="30" />
                            </div>
                            <div class="col-12 pt-2 text-center">
                                <img src="img/aw/campaign_logo.png" width="100%" height="160px" />
                            </div>
                        </div>
                        <div class="col-12 pt-5 text-center">
                            <h4 class="font-weight-bold" style="color: red;">ส่งรูปกันมาเยอะๆ น้า</h4>
                            <br />
                            <h4 class="font-weight-bold">รูปไหนสวยโดนใจ</h4>
                            <h4 class="font-weight-bold">รับของรางวัลไปเลย!!</h4>
                        </div>
                        <div class="fixed-bottom px-2 pb-4 buttonFooter text-center">
                            <button id="btnclose" class="col-12 btn py-2 btn-primary btn-lg">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <div id="divfinalImage3" style="width: 1100;height: 1110;"><img width="350" height="350" id="finalImage3" src="#" /></div>
        <div id="divfinalImage" style="width: 1100;height: 1110;"><img id="finalImage2" width="1122" height="1122" src="#" /></div>
        <img  id="finalImage" src="#" />
        <div id="divTest" > 
        </div>   -->

    <script src="https://code.jquery.com/jquery-2.2.0.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
        integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
        crossorigin="anonymous"></script>

    <script type="text/javascript" src="script/slick-1.8.1/slick/slick.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/10.14.0/sweetalert2.all.min.js"
        integrity="sha512-LXVbtSLdKM9Rpog8WtfAbD3Wks1NSDE7tMwOW3XbQTPQnaTrpIot0rzzekOslA1DVbXSVzS7c/lWZHRGkn3Xpg=="
        crossorigin="anonymous"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <script src="script/api.js"></script>

    <script src="script/Spinner/js/iosOverlay.js"></script> 
    <script src="script/Spinner/js/spin.min.js"></script> 
    <script src="script/Spinner/js/prettify.js"></script> 
    <script>
        var base64image = "";
        function submit() {

            if (listImages == 20) {
                alertPicLimit();
            } else {
                changePage("divUpload");
                var filepath = "photocontest.png";
                var currentData = new Date();
                var obj = { lineId: "Ue543604560f7aae69251d07f6ebefe4e", urlImage: filepath, urlImageSmall: filepath, submitDate: currentData, submitFrom: "Line" };
                var objJsonData = JSON.stringify(obj);


                var objImage = { data: base64image, picname: filepath };
                var objJsonImage = JSON.stringify(objImage);

                sendData(objJsonData, objJsonImage);
            }
        }
        function encodeImageFileAsURL(event) {
            var file = event.target.files[0];
            var reader = new FileReader();
            reader.onloadend = function () {
                console.log('RESULT', reader.result)
                base64image = reader.result;
            }
            reader.readAsDataURL(file);
        }
        function changePage(i) {
            var divPage = document.getElementById(i);
            divPage.style.display = 'none';
            var divThankyou = document.getElementById('divThankyou');
            divThankyou.style.display = 'block';
        }
        var loadFile = function (event) {
            validateSize(event);

            encodeImageFileAsURL(event);
            console.log(event);
            var output = document.getElementById('OutputImg');
            output.src = URL.createObjectURL(event.target.files[0]);
            output.onload = function () {
                URL.revokeObjectURL(output.src) // free memory
            }

            document.getElementById("btnUploadImg").src = "img/aw/Re_Upload_Button-1.png";

        };
        function validateSize(input) {
            const fileSize = input.target.files[0].size / 1024 / 1024; // in MiB
            if (fileSize > 3) {

                alert('File size exceeds 2 MiB');
                // $(file).val(''); //for clearing with Jquery
            } else {
                // Proceed further
            }
        }
        $(document).ready(function () {
            loading();
            var obj = { lineId: "Ue543604560f7aae69251d07f6ebefe4e" };
            var objJsonData = JSON.stringify(obj);

            getUserImages(objJsonData);
            $(".regular").slick({
                dots: true,
                slidesToShow: 4,
                slidesToScroll: 4,
                prevArrow: false,
                nextArrow: false
            });

        });
        function alertPicLimit() {
            Swal.fire({
                position: 'top',
                imageUrl: 'img/aw/campaign_logo.png',
                title: "<p style='text-align:center'><span style='color:red;'>ขออภัย</span> ท่านได้ทำการอัปโหลดรูปภาพครบตามจำนวนแล้ว</p>",
                text: "ขอบคุณที่ร่วมกิจกรรม",
                showCloseButton: true,
                confirmButtonClass: 'customSweetAlertConfirmButton',
                confirmButtonText: 'Close'

            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
            })
        }
        function loading(){
            var opts = {
		lines: 13, // The number of lines to draw
		length: 11, // The length of each line
		width: 5, // The line thickness
		radius: 17, // The radius of the inner circle
		corners: 1, // Corner roundness (0..1)
		rotate: 0, // The rotation offset
		color: '#FFF', // #rgb or #rrggbb
		speed: 1, // Rounds per second
		trail: 60, // Afterglow percentage
		shadow: false, // Whether to render a shadow
		hwaccel: false, // Whether to use hardware acceleration
		className: 'spinner', // The CSS class to assign to the spinner
		zIndex: 2e9, // The z-index (defaults to 2000000000)
		top: 'auto', // Top position relative to parent in px
		left: 'auto' // Left position relative to parent in px
	};
	var target = document.createElement("div");
	document.body.appendChild(target);
	var spinner = new Spinner(opts).spin(target);
	var overlay = iosOverlay({
		text: "Loading",
		spinner: spinner
	});
    overlay.hide();
    // window.setTimeout(function() {
		
	// }, 5e3);

	return false;
        }
    </script>
</body>

</html>